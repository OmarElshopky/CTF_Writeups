# CyberTalents
## Malware Reverse Engineering
<br>

### Challenge Name:
 [*Eye of Sauron*](https://cybertalents.com/challenges/malware/eye-of-sauron)
 
### Challenge Description
Can you find the key to pass?
Link: [https://s3-eu-west-1.amazonaws.com/talentchallenges/Reverse/Inkie.zip](https://s3-eu-west-1.amazonaws.com/talentchallenges/Reverse/Inkie.zip)

**Solved with my bestfriend @[wasfyelbaz](https://github.com/wasfyelbaz/)**

#### Answer
* Download exe file then upload it to [https://www.decompiler.com/](https://www.decompiler.com/) to decompile it.
* Open 'Inkie.exe/Inkie/Form1.cs' which contains the source code 
* Search about a function called when button clicked there is a one named *btnCheck_Click*
```cpp
    private void btnCheck_Click(object sender, EventArgs e)
		{
			//IL_0024: Unknown result type (might be due to invalid IL or missing references)
			((Control)label3).set_Text("47996655");
			MessageBox.Show(ShallHePass() ? "you shall pass" : "you shall not pass");
		}
```
* We pass accourding to returned value from **ShallHePass()** ,lets see it
```cpp
    private bool ShallHePass()
		{
			return ((Control)txtPass).get_Text() == reverse(((Control)label2).get_Text() + ((Control)label3).get_Text() + ((Control)label4).get_Text() + ((Control)label5).get_Text());
		}
```
* Our input must equal the reverse of the concatenation of label2 to label5 so we need to get their values.
* As this app use .NET framework the first function execute after opening the app is **InitializeComponent()** lets get our targets from it
```cpp
.
((Control)label2).set_Text("d0248b4e");
.
((Control)label3).set_Text("47886655");
.
((Control)label4).set_Text("83f05688");
.
((Control)label5).set_Text("c154b6ea");
.
```
* Until now our targets are:
```
label2 = "d0248b4e"
label3 = "47886655"
label4 = "83f05688"
label5 = "c154b6ea"
```
* Next there is a function called **Form1_Load** change label4 value when form1 load
```cpp
private void Form1_Load(object sender, EventArgs e)
		{
			((Control)label4).set_Text("83f05689");
		}
```
* Now our targets are:
```
label2 = "d0248b4e"
label3 = "47886655"
label4 = "83f05689"
label5 = "c154b6ea"
```
* The last one is when we click the button, label3 value change according to **btnCheck_Click()** so now we got this
```
label2 = "d0248b4e"
label3 = "47996655"
label4 = "83f05689"
label5 = "c154b6ea"
```
* Using python script we generate the pass
```py
pass = "d0248b4e" + "47996655" + "83f05689" + "c154b6ea"
pass[::-1]
```
* You got the Flag

 #### The Flag
 > ae6b451c98650f3855669974e4b8420d
